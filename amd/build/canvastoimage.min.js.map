{"version":3,"file":"canvastoimage.min.js","sources":["../src/canvastoimage.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @copyright  2023 sudile GbR (http://www.sudile.com)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author     Vincent Schneider <vincent.schneider@sudile.com>\n */\n\nexport const init = () => {\n    let downloadButton = document.getElementById('download-graph');\n    if (downloadButton !== null) {\n        downloadButton.addEventListener('click', function(e) {\n            e.preventDefault();\n            let downloadLink = document.createElement('a');\n            let name = this.getAttribute('data-name') + '_' + this.getAttribute('data-attemptid') + '.png';\n            downloadLink.setAttribute('download', name);\n            let canvas = document.querySelector('.chart-image canvas');\n            let dataUrl = canvas.toDataURL('image/png');\n            let url = dataUrl.replace(/^data:image\\/png/, 'data:application/octet-stream');\n            downloadLink.setAttribute('href', url);\n            downloadLink.click();\n        });\n    }\n\n};"],"names":["downloadButton","document","getElementById","addEventListener","e","preventDefault","downloadLink","createElement","name","this","getAttribute","setAttribute","url","querySelector","toDataURL","replace","click"],"mappings":"wKAqBoB,eACZA,eAAiBC,SAASC,eAAe,kBACtB,OAAnBF,gBACAA,eAAeG,iBAAiB,SAAS,SAASC,GAC9CA,EAAEC,qBACEC,aAAeL,SAASM,cAAc,KACtCC,KAAOC,KAAKC,aAAa,aAAe,IAAMD,KAAKC,aAAa,kBAAoB,OACxFJ,aAAaK,aAAa,WAAYH,UAGlCI,IAFSX,SAASY,cAAc,uBACfC,UAAU,aACbC,QAAQ,mBAAoB,iCAC9CT,aAAaK,aAAa,OAAQC,KAClCN,aAAaU"}